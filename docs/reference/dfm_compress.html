<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>recombine a dfm or fcm by combining identical dimension elements — dfm_compress • quanteda</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">quanteda</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>recombine a dfm or fcm by combining identical dimension elements</h1>
    </div>

    
    <p>"Compresses" or groups a <a href='dfm.html'>dfm</a> or <a href='fcm.html'>fcm</a> whose dimension names are
the same, for either documents or features.  This may happen, for instance,
if features are made equivalent through application of a thesaurus.  It may
also occur after lower-casing or stemming the features of a dfm, but this
should only be done in very rare cases (approaching never: it's better to do
this <em>before</em> constructing the dfm.)  It could also be needed after a 
<code><a href='cbind.dfm.html'>cbind.dfm</a></code> or <code><a href='cbind.dfm.html'>rbind.dfm</a></code> operation.

    <code>dfm_group</code> allows combining dfm documents by a grouping 
  variable, which can also be one of the <a href='docvars.html'>docvars</a> attached to the dfm.  This is
  identical in functionality to using the <code>"groups"</code> argument in
  <code><a href='dfm.html'>dfm</a></code>.</p>
    

    <pre class="usage"><span class='fu'>dfm_compress</span>(<span class='no'>x</span>, <span class='kw'>margin</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"both"</span>, <span class='st'>"documents"</span>, <span class='st'>"features"</span>))

<span class='fu'>dfm_group</span>(<span class='no'>x</span>, <span class='kw'>groups</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)

<span class='fu'>fcm_compress</span>(<span class='no'>x</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>input object, a <a href='dfm.html'>dfm</a> or <a href='fcm.html'>fcm</a></p></td>
    </tr>
    <tr>
      <th>margin</th>
      <td><p>character indicating on which margin to compress a dfm, either 
<code>"documents"</code>, <code>"features"</code>, or <code>"both"</code> (default).  For fcm
objects, <code>"documents"</code> has no effect.</p></td>
    </tr>
    <tr>
      <th>groups</th>
      <td><p>either: a character vector containing the names of document 
variables to be used for grouping; or a factor or object that can be 
coerced into a factor equal in length or rows to the number of documents</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments passed from generic to specific methods</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>dfm_compress</code> returns a <a href='dfm.html'>dfm</a> whose dimensions have been
  recombined by summing the cells across identical dimension names
  (<a href='docnames.html'>docnames</a> or <a href='featnames.html'>featnames</a>).  The <a href='docvars.html'>docvars</a> will be
  preserved for combining by features but not when documents are combined.

<code>dfm_group</code> returns a <a href='dfm.html'>dfm</a> whose documents are equal to
  the unique group combinations, and whose cell values are the sums of the
  previous values summed by group.  This currently erases any docvars in the dfm.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p><code>fcm_compress</code> works only when the <a href='fcm.html'>fcm</a> was created with a document
context.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># dfm_compress examples</span>
<span class='no'>mat</span> <span class='kw'>&lt;-</span> <span class='fu'>rbind</span>(<span class='fu'><a href='dfm.html'>dfm</a></span>(<span class='fu'>c</span>(<span class='st'>"b A A"</span>, <span class='st'>"C C a b B"</span>), <span class='kw'>tolower</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>),
             <span class='fu'><a href='dfm.html'>dfm</a></span>(<span class='st'>"A C C C C C"</span>, <span class='kw'>tolower</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>))</div><div class='output co'>#&gt; </div><div class='input'><span class='fu'>colnames</span>(<span class='no'>mat</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='char_tolower.html'>char_tolower</a></span>(<span class='fu'><a href='featnames.html'>featnames</a></span>(<span class='no'>mat</span>))
<span class='no'>mat</span></div><div class='output co'>#&gt; Document-feature matrix of: 3 documents, 5 features (46.7% sparse).
#&gt; 3 x 5 sparse Matrix of class "dfmSparse"
#&gt;        features
#&gt; docs    a c b a b
#&gt;   text1 2 0 1 0 0
#&gt;   text2 0 2 1 1 1
#&gt;   text1 1 5 0 0 0</div><div class='input'><span class='fu'>dfm_compress</span>(<span class='no'>mat</span>, <span class='kw'>margin</span> <span class='kw'>=</span> <span class='st'>"documents"</span>)</div><div class='output co'>#&gt; Document-feature matrix of: 2 documents, 5 features (30% sparse).
#&gt; 2 x 5 sparse Matrix of class "dfmSparse"
#&gt;        features
#&gt; docs    a c b a b
#&gt;   text1 3 5 1 0 0
#&gt;   text2 0 2 1 1 1</div><div class='input'><span class='fu'>dfm_compress</span>(<span class='no'>mat</span>, <span class='kw'>margin</span> <span class='kw'>=</span> <span class='st'>"features"</span>)</div><div class='output co'>#&gt; Document-feature matrix of: 3 documents, 3 features (22.2% sparse).
#&gt; 3 x 3 sparse Matrix of class "dfmSparse"
#&gt;        features
#&gt; docs    a c b
#&gt;   text1 2 0 1
#&gt;   text2 1 2 2
#&gt;   text1 1 5 0</div><div class='input'><span class='fu'>dfm_compress</span>(<span class='no'>mat</span>)</div><div class='output co'>#&gt; Document-feature matrix of: 2 documents, 3 features (0% sparse).
#&gt; 2 x 3 sparse Matrix of class "dfmSparse"
#&gt;        features
#&gt; docs    a c b
#&gt;   text1 3 5 1
#&gt;   text2 1 2 2</div><div class='input'>
<span class='co'># no effect if no compression needed</span>
<span class='no'>compactdfm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='dfm.html'>dfm</a></span>(<span class='no'>data_corpus_inaugural</span>[<span class='fl'>1</span>:<span class='fl'>5</span>])
<span class='fu'>dim</span>(<span class='no'>compactdfm</span>)</div><div class='output co'>#&gt; [1]    5 1947</div><div class='input'><span class='fu'>dim</span>(<span class='fu'>dfm_compress</span>(<span class='no'>compactdfm</span>))</div><div class='output co'>#&gt; [1]    5 1947</div><div class='input'>
<span class='co'># dfm_group examples</span>
<span class='no'>mycorpus</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='corpus.html'>corpus</a></span>(<span class='fu'>c</span>(<span class='st'>"a a b"</span>, <span class='st'>"a b c c"</span>, <span class='st'>"a c d d"</span>, <span class='st'>"a c c d"</span>),
                   <span class='kw'>docvars</span> <span class='kw'>=</span> <span class='fu'>data.frame</span>(<span class='kw'>grp</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"grp1"</span>, <span class='st'>"grp1"</span>, <span class='st'>"grp2"</span>, <span class='st'>"grp2"</span>)))
<span class='no'>mydfm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='dfm.html'>dfm</a></span>(<span class='no'>mycorpus</span>)
<span class='fu'>dfm_group</span>(<span class='no'>mydfm</span>, <span class='kw'>groups</span> <span class='kw'>=</span> <span class='st'>"grp"</span>)</div><div class='output co'>#&gt; Document-feature matrix of: 2 documents, 4 features (25% sparse).
#&gt; 2 x 4 sparse Matrix of class "dfmSparse"
#&gt;       features
#&gt; docs   a b c d
#&gt;   grp1 3 2 2 0
#&gt;   grp2 2 0 3 3</div><div class='input'><span class='fu'>dfm_group</span>(<span class='no'>mydfm</span>, <span class='kw'>groups</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>2</span>))</div><div class='output co'>#&gt; Document-feature matrix of: 2 documents, 4 features (25% sparse).
#&gt; 2 x 4 sparse Matrix of class "dfmSparse"
#&gt;     features
#&gt; docs a b c d
#&gt;    1 3 2 2 0
#&gt;    2 2 0 3 3</div><div class='input'>
<span class='co'># equivalent</span>
<span class='fu'><a href='dfm.html'>dfm</a></span>(<span class='no'>mydfm</span>, <span class='kw'>groups</span> <span class='kw'>=</span> <span class='st'>"grp"</span>)</div><div class='output co'>#&gt; Document-feature matrix of: 2 documents, 4 features (25% sparse).
#&gt; 2 x 4 sparse Matrix of class "dfmSparse"
#&gt;       features
#&gt; docs   a b c d
#&gt;   grp1 3 2 2 0
#&gt;   grp2 2 0 3 3</div><div class='input'><span class='fu'><a href='dfm.html'>dfm</a></span>(<span class='no'>mydfm</span>, <span class='kw'>groups</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>2</span>))</div><div class='output co'>#&gt; Document-feature matrix of: 2 documents, 4 features (25% sparse).
#&gt; 2 x 4 sparse Matrix of class "dfmSparse"
#&gt;     features
#&gt; docs a b c d
#&gt;    1 3 2 2 0
#&gt;    2 2 0 3 3</div><div class='input'><span class='co'># compress an fcm</span>
<span class='no'>myfcm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fcm.html'>fcm</a></span>(<span class='fu'><a href='tokens.html'>tokens</a></span>(<span class='st'>"A D a C E a d F e B A C E D"</span>),
             <span class='kw'>context</span> <span class='kw'>=</span> <span class='st'>"window"</span>, <span class='kw'>window</span> <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='co'>## this will produce an error:</span>
<span class='co'># fcm_compress(myfcm)</span>

<span class='no'>txt</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='st'>"The fox JUMPED over the dog."</span>,
         <span class='st'>"The dog jumped over the fox."</span>)
<span class='no'>toks</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='tokens.html'>tokens</a></span>(<span class='no'>txt</span>, <span class='kw'>remove_punct</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>myfcm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fcm.html'>fcm</a></span>(<span class='no'>toks</span>, <span class='kw'>context</span> <span class='kw'>=</span> <span class='st'>"document"</span>)</div><div class='output co'>#&gt; <span class='error'>Error in get(".SigLength", envir = env): object '.SigLength' not found</span></div><div class='input'><span class='fu'>colnames</span>(<span class='no'>myfcm</span>) <span class='kw'>&lt;-</span> <span class='fu'>rownames</span>(<span class='no'>myfcm</span>) <span class='kw'>&lt;-</span> <span class='fu'>tolower</span>(<span class='fu'>colnames</span>(<span class='no'>myfcm</span>))
<span class='fu'>colnames</span>(<span class='no'>myfcm</span>)[<span class='fl'>5</span>] <span class='kw'>&lt;-</span> <span class='fu'>rownames</span>(<span class='no'>myfcm</span>)[<span class='fl'>5</span>] <span class='kw'>&lt;-</span> <span class='st'>"fox"</span>
<span class='no'>myfcm</span></div><div class='output co'>#&gt; Feature co-occurrence matrix of: 9 by 9 features.
#&gt; 9 x 9 sparse Matrix of class "fcm"
#&gt;         features
#&gt; features a d a c fox d f e b
#&gt;      a   . 2 1 2   1 . 1 1 1
#&gt;      d   . . 1 2   2 . . . .
#&gt;      a   . . 1 2   2 1 1 1 .
#&gt;      c   . . . .   2 1 . 1 1
#&gt;      fox . . . .   . 1 1 . 1
#&gt;      d   . . . .   . . 1 1 1
#&gt;      f   . . . .   . . . 1 1
#&gt;      e   . . . .   . . . . 1
#&gt;      b   . . . .   . . . . .</div><div class='input'><span class='fu'>fcm_compress</span>(<span class='no'>myfcm</span>)</div><div class='output co'>#&gt; <span class='error'>Error in fcm_compress(myfcm): compress_fcm invalid if fcm was created with a window context</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#note">Note</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Kenneth Benoit.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
