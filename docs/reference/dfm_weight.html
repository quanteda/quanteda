<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Weight the feature frequencies in a dfm — dfm_weight • quanteda</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/readable/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>


  <link href="../extra.css" rel="stylesheet">
  <script src="../extra.js"></script>

<meta property="og:title" content="Weight the feature frequencies in a dfm — dfm_weight" />
<meta property="og:description" content="Weight the feature frequencies in a dfm" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-144616-24"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-144616-24');
</script>


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">quanteda</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Quick Start
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/quickstart.html">Quick Start Guide</a>
    </li>
    <li>
      <a href="../articles/pkgdown/quickstart_es.html">Guía de Inicio Rápido</a>
    </li>
    <li>
      <a href="../articles/pkgdown/quickstart_cn.html">快速入门指南</a>
    </li>
    <li>
      <a href="../articles/pkgdown/quickstart_ja.html">クイック・スタートガイド</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Features
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/pkgdown/comparison.html">Feature comparison</a>
    </li>
    <li>
      <a href="../articles/pkgdown/design.html">Package design</a>
    </li>
    <li>
      <a href="../news/index.html">Changelog</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/pkgdown/examples/phrase.html">Multi-word expressions</a>
    </li>
    <li>
      <a href="../articles/pkgdown/examples/plotting.html">Textual data visualization</a>
    </li>
    <li>
      <a href="../articles/pkgdown/examples/lsa.html">Latent Semantic Analysis (LSA)</a>
    </li>
    <li>
      <a href="../articles/pkgdown/examples/chinese.html">Chinese text analysis</a>
    </li>
    <li>
      <a href="../articles/pkgdown/examples/twitter.html">Social media analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Replications
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/pkgdown/replication/digital-humanities.html">Text Analysis with R for Students of Literature</a>
    </li>
    <li>
      <a href="../articles/pkgdown/replication/text2vec.html">Word embedding (word2vec)</a>
    </li>
    <li>
      <a href="../articles/pkgdown/replication/qss.html">Quantitative Social Science Ch. 5.1</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/quanteda/quanteda">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Weight the feature frequencies in a dfm</h1>
    
    <div class="hidden name"><code>dfm_weight.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Weight the feature frequencies in a dfm</p>
    </div>

    <pre class="usage"><span class='fu'>dfm_weight</span>(
  <span class='no'>x</span>,
  <span class='kw'>scheme</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"count"</span>, <span class='st'>"prop"</span>, <span class='st'>"propmax"</span>, <span class='st'>"logcount"</span>, <span class='st'>"boolean"</span>, <span class='st'>"augmented"</span>, <span class='st'>"logave"</span>),
  <span class='kw'>weights</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>base</span> <span class='kw'>=</span> <span class='fl'>10</span>,
  <span class='kw'>K</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
  <span class='kw'>force</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)

<span class='fu'>dfm_smooth</span>(<span class='no'>x</span>, <span class='kw'>smoothing</span> <span class='kw'>=</span> <span class='fl'>1</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>document-feature matrix created by <a href='dfm.html'>dfm</a></p></td>
    </tr>
    <tr>
      <th>scheme</th>
      <td><p>a label of the weight type:</p><dl class='dl-horizontal'>
  <dt><code>count</code></dt><dd><p>\(tf_{ij}\), an integer feature count (default when a dfm is created)</p></dd>
  <dt><code>prop</code></dt><dd><p>the proportion of the feature counts of total feature
  counts (aka relative frequency), calculated as \(tf_{ij} / \sum_j tf_{ij}\)</p></dd>
  <dt><code>propmax</code></dt><dd><p>the proportion of the feature counts of the highest
  feature count in a document, \(tf_{ij} / \textrm{max}_j tf_{ij}\)</p></dd>
  <dt><code>logcount</code></dt><dd><p>take the 1 + the logarithm of each count, for the
  given base, or 0 if the count was zero: \(1 +
  \textrm{log}_{base}(tf_{ij})\) if \(tf_{ij} &gt; 0\), or 0 otherwise.</p></dd>
  <dt><code>boolean</code></dt><dd><p>recode all non-zero counts as 1</p></dd>
  <dt><code>augmented</code></dt><dd><p>equivalent to \(K + (1 - K) *\) <code>dfm_weight(x,
  "propmax")</code></p></dd>
  <dt><code>logave</code></dt><dd><p>1 + the log of the counts) / (1 + log of the counts / the average count within document), or
  $$\frac{1 + \textrm{log}_{base} tf_{ij}}{1 + \textrm{log}_{base}(\sum_j tf_{ij} / N_i)}$$</p></dd>

</dl></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>if <code>scheme</code> is unused, then <code>weights</code> can be a named
numeric vector of weights to be applied to the dfm, where the names of the
vector correspond to feature labels of the dfm, and the weights will be
applied as multipliers to the existing feature counts for the corresponding
named features.  Any features not named will be assigned a weight of 1.0
(meaning they will be unchanged).</p></td>
    </tr>
    <tr>
      <th>base</th>
      <td><p>base for the logarithm when <code>scheme</code> is <code>"logcount"</code> or 
<code>logave</code></p></td>
    </tr>
    <tr>
      <th>K</th>
      <td><p>the K for the augmentation when <code>scheme = "augmented"</code></p></td>
    </tr>
    <tr>
      <th>force</th>
      <td><p>logical; if <code>TRUE</code>, apply weighting scheme even if the dfm
has been weighted before.  This can result in invalid weights, such as as
weighting by <code>"prop"</code> after applying <code>"logcount"</code>, or after
having grouped a dfm using <code><a href='dfm_group.html'>dfm_group</a></code>.</p></td>
    </tr>
    <tr>
      <th>smoothing</th>
      <td><p>constant added to the dfm cells for smoothing, default is 1</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>dfm_weight</code> returns the dfm with weighted values.  Note the
  because the default weighting scheme is <code>"count"</code>, simply calling this
  function on an unweighted dfm will return the same object.  Many users will
  want the normalized dfm consisting of the proportions of the feature counts
  within each document, which requires setting <code>scheme = "prop"</code>.</p>
<p><code>dfm_smooth</code> returns a dfm whose values have been smoothed by
  adding the <code>smoothing</code> amount. Note that this effectively converts a
  matrix from sparse to dense format, so may exceed memory requirements
  depending on the size of your input matrix.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Manning, C.D., Raghavan, P., &amp; Schütze, H. (2008).
  <em>An Introduction to Information Retrieval</em>. Cambridge: Cambridge University Press. 
  <a href='https://nlp.stanford.edu/IR-book/pdf/irbookonlinereading.pdf'>https://nlp.stanford.edu/IR-book/pdf/irbookonlinereading.pdf</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='dfm_tfidf.html'>dfm_tfidf</a></code>, <code><a href='docfreq.html'>docfreq</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>dfmat1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='dfm.html'>dfm</a></span>(<span class='no'>data_corpus_inaugural</span>)

<span class='no'>dfmat2</span> <span class='kw'>&lt;-</span> <span class='fu'>dfm_weight</span>(<span class='no'>dfmat1</span>, <span class='kw'>scheme</span> <span class='kw'>=</span> <span class='st'>"prop"</span>)
<span class='fu'><a href='topfeatures.html'>topfeatures</a></span>(<span class='no'>dfmat2</span>)</div><div class='output co'>#&gt;       the         ,        of       and         .        to        in       our 
#&gt; 3.7910332 2.7639649 2.6821863 2.0782035 1.9594539 1.7643366 1.0695645 0.8731637 
#&gt;         a        we 
#&gt; 0.8593092 0.7726443 </div><div class='input'><span class='no'>dfmat3</span> <span class='kw'>&lt;-</span> <span class='fu'>dfm_weight</span>(<span class='no'>dfmat1</span>)
<span class='fu'><a href='topfeatures.html'>topfeatures</a></span>(<span class='no'>dfmat3</span>)</div><div class='output co'>#&gt;   the    of     ,   and     .    to    in     a   our  that 
#&gt; 10082  7103  7026  5310  4945  4526  2785  2246  2181  1789 </div><div class='input'><span class='no'>dfmat4</span> <span class='kw'>&lt;-</span> <span class='fu'>dfm_weight</span>(<span class='no'>dfmat1</span>, <span class='kw'>scheme</span> <span class='kw'>=</span> <span class='st'>"logcount"</span>)
<span class='fu'><a href='topfeatures.html'>topfeatures</a></span>(<span class='no'>dfmat4</span>)</div><div class='output co'>#&gt;      the        ,       of      and        .       to       in        a 
#&gt; 182.1856 174.3182 173.3837 167.1782 164.9945 163.2151 150.4070 143.6032 
#&gt;      our     that 
#&gt; 140.7424 138.9939 </div><div class='input'><span class='no'>dfmat5</span> <span class='kw'>&lt;-</span> <span class='fu'>dfm_weight</span>(<span class='no'>dfmat1</span>, <span class='kw'>scheme</span> <span class='kw'>=</span> <span class='st'>"logave"</span>)
<span class='fu'><a href='topfeatures.html'>topfeatures</a></span>(<span class='no'>dfmat5</span>)</div><div class='output co'>#&gt;       the         ,        of       and         .        to        in         a 
#&gt; 121.98599 116.64229 116.06902 111.83340 110.34098 109.25338 100.55961  95.75088 
#&gt;       our      that 
#&gt;  93.81347  92.88474 </div><div class='input'>
<span class='co'># combine these methods for more complex dfm_weightings, e.g. as in Section 6.4</span>
<span class='co'># of Introduction to Information Retrieval</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='fu'><a href='dfm_tfidf.html'>dfm_tfidf</a></span>(<span class='no'>dfmat1</span>, <span class='kw'>scheme_tf</span> <span class='kw'>=</span> <span class='st'>"logcount"</span>))</div><div class='output co'>#&gt; Document-feature matrix of: 6 documents, 9,357 features (93.8% sparse).</div><div class='input'>
<span class='co'># apply numeric weights</span>
<span class='no'>str</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"apple is better than banana"</span>, <span class='st'>"banana banana apple much better"</span>)
(<span class='no'>dfmat6</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='dfm.html'>dfm</a></span>(<span class='no'>str</span>, <span class='kw'>remove</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/stopwords/man/stopwords.html'>stopwords</a></span>(<span class='st'>"english"</span>)))</div><div class='output co'>#&gt; Document-feature matrix of: 2 documents, 4 features (12.5% sparse).
#&gt; 2 x 4 sparse Matrix of class "dfm"
#&gt;        features
#&gt; docs    apple better banana much
#&gt;   text1     1      1      1    0
#&gt;   text2     1      1      2    1</div><div class='input'><span class='fu'>dfm_weight</span>(<span class='no'>dfmat6</span>, <span class='kw'>weights</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>apple</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>banana</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>much</span> <span class='kw'>=</span> <span class='fl'>0.5</span>))</div><div class='output co'>#&gt; Document-feature matrix of: 2 documents, 4 features (12.5% sparse).
#&gt; 2 x 4 sparse Matrix of class "dfm"
#&gt;        features
#&gt; docs    apple better banana much
#&gt;   text1     5      1      3  0  
#&gt;   text2     5      1      6  0.5</div><div class='input'>
<span class='co'># smooth the dfm</span>
<span class='no'>dfmat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='dfm.html'>dfm</a></span>(<span class='no'>data_corpus_inaugural</span>)
<span class='fu'>dfm_smooth</span>(<span class='no'>dfmat</span>, <span class='fl'>0.5</span>)</div><div class='output co'>#&gt; Document-feature matrix of: 58 documents, 9,357 features (0.0% sparse).</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Kenneth Benoit, Kohei Watanabe, Haiyan Wang, Paul Nulty, Adam Obeng, Stefan Müller, Akitaka Matsuo, Jiong Wei Lua, Patrick O. Perry, Jouni Kuha, Benjamin Lauderdale, William Lowe, European Research Council.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '9b4ef7fd791dc6075154d3ebd7b12acf',
    indexName: 'quanteda',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


